!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).PerfLog=t()}(this,function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;arguments.length>t;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach(function(t){n(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function i(){return"object"===("undefined"==typeof exports?"undefined":e(exports))&&"undefined"!=typeof module?global:window}var a="_NJ_TIME_TRACKER",l="_NJ_TIME_TRACKER_ENABLE",c=!1,u="_DEFAULT_KEY",f={running:!1,duration:0,frequency:0,startUnix:0,endUnix:0};return new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=i();t[a]||(t[a]=n({},u,o({},f)),t[l]=c),this.global=t,this.isEnable=t[l],this.tracker=t[a]}var r,s,y;return r=e,(s=[{key:"getAllKey",value:function(){return this.tracker&&Object.keys(this.tracker)}},{key:"haveKey",value:function(e){return!!this.tracker[e]}},{key:"createKey",value:function(e){this.tracker[e]=o({},f)}},{key:"setLog",value:function(e,t){this.tracker[e]=t}},{key:"getLog",value:function(e){return this.tracker[e]}},{key:"enable",value:function(e){void 0===e&&console.info("---调用enable方法没有入参，默认不启动日志统计"),this.global[l]=!!e,this.isEnable=this.global[l]}},{key:"start",value:function(){if(this.isEnable){var e=Array.prototype.slice.call(arguments);e.length||(e=[u]);for(var t=0;e.length>t;t++){var n=e[t];this.haveKey(n)||this.createKey(n);var r=this.getLog(n);r.running||(r.running=!0,r.frequency+=1,r.startUnix=(new Date).getTime())}}}},{key:"end",value:function(){if(this.isEnable){var e=Array.prototype.slice.call(arguments);e.length||(e=[u]);for(var t=0;e.length>t;t++){var n=e[t];if(this.haveKey(n)){var r=this.getLog(n);if(r.running){r.running=!1,r.endUnix=(new Date).getTime();var o=r.endUnix-r.startUnix;o&&(r.duration=r.duration+o)}else console.log("---没有启动统计key: ".concat(n," "))}else console.log("---没有启动统计key: ".concat(n," "))}}}},{key:"console",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return""+e},t}(function(){if(this.isEnable){var e=Array.prototype.slice.call(arguments);e.length||(e=this.getAllKey());for(var t=[],n=0;e.length>n;n++){var r=e[n];if(this.haveKey(r)){var o=this.getLog(r);t.push({label:r,"duration(ms)":o.duration,"frequency(次)":o.frequency})}else console.log("---\x3e没有启动统计key: ".concat(r," "))}console.table&&"function"==typeof console.table?console.table(t):console.log(t)}})},{key:"clear",value:function(){var e=this;if(this.isEnable){var t=Array.prototype.slice.call(arguments);t.length||(t=[u]),t.forEach(function(t){e.haveKey(t)&&e.setLog(t,o({},f))})}}}])&&t(r.prototype,s),y&&t(r,y),e}())});
